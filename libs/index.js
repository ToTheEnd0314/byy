/*!
 * moon.js v123
 * (c) 2018-2019 Horses Lee
 * Released under the MIT License.
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function n(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function r(t){console.error("Moon Error:\n"+t)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}function i(t){return"[object String]"===Object.prototype.toString.call(t)}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw TypeError("Bind must be called on a function");var e=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r?this:t,e.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(r.prototype=this.prototype),o.prototype=new r,o}),Array.isArray||(Array.isArray=function(t){return Boolean(t&&"[object Array]"===Object.prototype.toString.call(Object(t)))}),Array.prototype.find||(Array.prototype.find=function(t){var e;if(t){for(var n=this,r=0;r<n.length;r++)if(t(n[r],r)){e=n[r];break}}else console.error("[Find]: params[0] is invalid");return e}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){var e=-1;if(t){for(var n=0;n<this.length;n++)if(t(this[n],n)){e=n;break}}else console.error("[FindIndex]: params[0] is invalid");return e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)e.push(n);return e}),Array.prototype.map||(Array.prototype.map=function(t){for(var e=[],n=this.slice(0),r=0;r<n.length;r++)e.push(t(n[r],r,n));return e}),Array.prototype.filter||(Array.prototype.filter=function(t){for(var e=[],n=this.slice(0),r=0;r<n.length;r++)t(n[r],r)&&e.push(n[r]);return e}),"function"!=typeof Object.assign&&(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n}),Array.prototype.reduce||(Array.prototype.reduce=function(t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var e,n=Object(this),r=n.length>>>0,o=0;if(arguments.length>=2)e=arguments[1];else{for(;o<r&&!(o in n);)o++;if(o>=r)throw new TypeError("Reduce of empty array with no initial value");e=n[o++]}for(;o<r;)o in n&&(e=t(e,n[o],o,n)),o++;return e}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),o=r.length>>>0;if(0===o)return-1;var i=+e||0;if(Math.abs(i)===Infinity&&(i=0),i>=o)return-1;for(n=Math.max(i>=0?i:o-Math.abs(i),0);n<o;){if(n in r&&r[n]===t)return n;n++}return-1});var s={stop:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},prevent:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}};function a(t,e){for(var n in e)t.style.setAttribute?t.style.setAttribute(n,e[n]):t.style[n]=e[n]}function c(t,e,n){var r=function(r){var o=r.split("."),i=o[0],a=o[1],c=e[r],p=c[0],l=c.slice(1);t["on"+i]=null,t["on"+i]=function(t){var e=t||window.event;a&&s[a]&&s[a](e),l=l.reduce((function(t,n){return"$event"===n?t.push(e):t.push(n),t}),[]),p.apply(n,l)}};for(var o in e)r(o)}function p(t,e,n){var r=d(t,e,"0");r&&function(t,e,n,r){for(var o in t){var i=l(e.$el,o);for(var s in t[o]){if("props"===s)(u=h(n,o))._updateChildComponent(t[o][s]);else if("style"===s)a(i,t[o][s]);else if("replace"===s){var p=void 0;if("component"===t[o][s].nodeType){var u=Object.assign(e.components[t[o][s].tag],{props:t[o][s].props});t[o][s].component=new f(u,e,e.$Moon),p=t[o][s].component.$el}else p=e._createElement(t[o][s]);i.parentNode.replaceChild(p,i)}else if("add"===s)for(var d=0,y=t[o][s];d<y.length;d++){var v=y[d];"component"===v.nodeType?i.appendChild(v.component.$el):i.appendChild(e._createElement(v))}else if("remove"===s)for(var m=0;m<t[o][s];m++){var g=i.childNodes[i.childNodes.length-1];i.removeChild(g)}else"delete"===s?i.parentNode.removeChild(i):"on"===s?c(i,t[o][s],e):i[s]=t[o][s]}}}(r,n,t)}function l(t,e){for(var n=e.split("-"),r=1;r<n.length;r++)t=t.childNodes[n[r]];return t}function h(t,e){for(var n=e.split("-"),r=t,o=1;o<n.length;o++)r=r.children[n[o]];return r.component}function u(t,e){var n=!0;if(t.length!==e.length)n=!1;else for(var r=1;r<t.length;r++)if(t[r]!==e[r]){n=!1;break}return n}function d(t,e,r){var o={},s=(t.bind,t.children),a=t.nodeType,c=t.tag,p=t.nodeValue,l=(t.component,n(t,["bind","children","nodeType","tag","nodeValue","component"])),h=(e.bind,e.children),f=e.nodeType,y=e.tag,v=e.nodeValue,m=(e.component,n(e,["bind","children","nodeType","tag","nodeValue","component"])),g=function(t,e,n){var r={};if(t&&!e)r[n]=Object.assign({},r[n],{add:[t]});else if(e&&!t)r[n]=Object.assign({},r[n],{"delete":!0});else if(t&&e){t.length>e.length?(r[n]=Object.assign({},r[n],{add:t.slice(e.length-t.length)}),t=t.slice(0,e.length-t.length)):t.length<e.length&&(r[n]=Object.assign({},r[n],{remove:e.length-t.length}));for(var o=0;o<t.length;o++){var i=d(t[o],e[o],n+"-"+o);i&&(r=Object.assign({},r,i))}}return Object.keys(r).length>0?r:null}(s,h,r);return o[r]=function(t,e){var n={},r=function(r){var o,s;if(i(t[r]))n=Object.assign({},n,((o={})[r]=t[r],o));else if("className"===r)n[r]=Object.keys(t[r]).reduce((function(e,n){return t[r][n]&&(e+=" "+n),e}),"").slice(1);else for(var a in t[r])if(t[r]&&e[r]){("on"===r?u(t[r][a],e[r][a]):t[r][a]===e[r][a])||(n[r]=Object.assign({},n[r],((s={})[a]=t[r][a],s)))}};for(var o in t)r(o);return Object.keys(n).length>0?n:null}(l,m),g&&(o=Object.assign({},o,g)),a!==f||c!==y?o[r]=Object.assign({},o[r],{replace:t}):p!==v&&(o[r]=Object.assign({},o[r],{nodeValue:p})),Object.keys(o).length>0?o:null}var f=function(){function t(t,e,n){for(var r in this.components=t.components,this.data=t.data,this.props=t.props,this.render=t.render,this.methods=t.methods,this.watch=t.watch,this.mounted=t.mounted,this.created=t.created,this.name=t.name,this._binds={},this._tickers=[],this.$el,this.$Moon=n,n.$inserts)this[r]=n.$inserts[r];this._updateTimer=null,e&&(this.$parent=e),this._createComponent()}return t.prototype.$get=function(t){var e,n;return e=this.data&&(this.data[t]||0===this.data[t]||!1===this.data[t]||""===this.data[t])?this.data[t]:this.props&&(this.props[t]||0===this.props[t]||!1===this.props[t]||""===this.props[t])?this.props[t]:undefined,n=e,"[object Array]"===Object.prototype.toString.call(n)?e=e.slice(0):o(e)&&(e=Object.assign({},e)),e},t.prototype.$set=function(t,e){var n=this;this.data[t]!==e&&(this.__trigWatchers(t,e,this.data[t]),this.data[t]=e,clearTimeout(this._updateTimer),this._updateTimer=setTimeout((function(){var t=n._updateVNode(n.render(n._createVnode.bind(n)),n._vNode);p(t,n._vNode,n),n._vNode=t}),0))},t.prototype.$emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.$parent._binds[t]&&this.$parent._binds[t].apply(this.$parent,e)},t.prototype.$nextTick=function(t){this._tickers.push(t)},t.prototype.__trigTickers=function(){for(var t=0,e=this._tickers;t<e.length;t++){(0,e[t])()}this._tickers=[]},t.prototype.__trigWatchers=function(t,e,n){this.watch&&this.watch[t]&&this.watch[t].call(this,e,n)},t.prototype._updateVNode=function(e,n){e.children=e.children||[];for(var r=0;r<e.children.length;r++)if("component"===e.children[r].nodeType)e.children[r].component instanceof t||(n&&n.children[r]?e.children[r]=Object.assign(e.children[r],{component:n.children[r].component}):e.children[r].component=new t(e.children[r].component,this,this.$Moon));else{var o=n&&n.children[r];this._updateVNode(e.children[r],o)}return e},t.prototype._createElement=function(e){var n;if(1===e.nodeType?n=document.createElement(e.tag):3===e.nodeType?n=document.createTextNode(e.nodeValue):(e.component=new t(e.component,this,this.$Moon),n=e.component.$el),e.children)for(var s=0,p=e.children;s<p.length;s++){var l=p[s];n.appendChild(this._createElement(l))}return a(n,e.style),function(t,e,n){var s=function(s){"className"===s?o(e[s])?t[s]=Object.keys(e[s]).filter((function(t){return e[s][t]})).join(" "):i(e[s])?t[s]=e[s]:r("The className must be string or object"):"on"===s?c(t,e[s],n):"style"===s?a(t,e[s]):"component"!==s&&"nodeType"!==s&&"children"!==s&&"tag"!==s&&(t[s]=e[s])};for(var p in e)s(p)}(n,e,this),n},t.prototype._createVnode=function(t,n,r){var i,s=[],a=1;if(this.components&&this.components[t]){if(i=this.__deepClone(this.components[t]),n&&(n.props&&i.props&&(i.props=Object.assign(i.props,n.props)),n.bind))for(var c in n.bind)this._binds[c]=n.bind[c];a="component"}return r&&r.length>0&&(s=r.reduce((function(t,e){return o(e)?t.push(e):t.push({nodeType:3,nodeValue:e,children:[]}),t}),[])),e(e({tag:t,children:s},n),{component:i,nodeType:a})},t.prototype._updateChildComponent=function(t){for(var e in t)this.__trigWatchers(e,t[e],this.props[e]);this.props=Object.assign(this.props,t);var n=this._updateVNode(this.render(this._createVnode.bind(this)),this._vNode);p(n,this._vNode,this),this._vNode=n},t.prototype.__deepClone=function(e){var n={};for(var r in e)e.hasOwnProperty(r)&&(!o(e[r])||e[r]instanceof t?n[r]=e[r]:n[r]=this.__deepClone(e[r]));return n},t.prototype.__transferMethods=function(){Object.assign(this,e({},this.methods))},t.prototype._createComponent=function(){this.__transferMethods(),this._vNode=this.render(this._createVnode.bind(this)),this.$el=this._createElement(this._vNode),this.created&&this.created()},t}(),y=function(e){function n(t){var n=e.call(this)||this;return n.$options=Object.assign({el:"app",$el:null,render:null,autoRender:!0},t),n._vm,n.$options.name||n._init("byy"),n}return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,e),n.prototype._init=function(t){"byy"===t?this.$options.render(this._render.bind(this,"byy")):r("The function named [_init] is a inner function, you can't call it directly")},n.prototype._triggerMounter=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];"component"===r.nodeType&&r.component.mounted&&r.component.mounted(),r.children&&this._triggerMounter(r.children)}},n.prototype.$mount=function(){this.$options.$el.appendChild(this._vm.$el),this._vm.mounted&&this._vm.mounted(),this._triggerMounter(this._vm._vNode.children)},n.prototype._render=function(t,e){"byy"===t?o(e)?(this.$options.$el=document.querySelector(this.$options.el||this.$options.el),this._vm=new f(e,null,n),this.$options.autoRender&&this.$mount()):r("You must init Moon with a component"):r("The function named [_render] is a inner function, you can't call it directly")},n}(function(){function t(){}return t.use=function(t,e){this.$inserts[t]=e},t.$inserts={},t}());export default y;
